{% extends "base.html" %}

{% block content %}
<style>
    .rounded-image {
        max-width: 300px; /* Максимальная ширина изображения */
        height: 300px; /* Автоматический расчет высоты для поддержки пропорций */
        border-radius: 50%; /* Создание круглого изображения */
    }
</style>
<h1>Профиль</h1>
<div class="container">
    <div class="row">
        <div class="col">
            <img src="../{{avatar}}" alt="фото профиля" class="rounded-image">
        </div>
        <div class="col">
            <div class="row">
                <div class="col">
                    <div class="h5 pb-2 mb-4 text-info border-bottom border-info">
                        <p><strong>Подписчики: {{folowers}}</strong></p>
                    </div>
                </div>
                <div class="col">
                    <div class="h5 pb-2 mb-4 text-info border-bottom border-info">
                        <p><strong>Подписки: {{folow}}</strong></p>
                    </div>
                </div>
            </div>

            <div class="shadow p-3 mb-5 bg-body-tertiary rounded">
                <h3>{{name}}</h3>
                <hr>
                <p>{{bio}}</p>
            </div>
        </div>
    </div>
</div>
{% if current_user.is_authenticated %}
    {% if current_user.id == accid %}
        <a class="btn btn-primary" href="/edit_profile" style="width: 27%; margin: 20px">Редактировать</a>
    {% else %}
        {% if is_follow %}
            <a class="btn btn-danger" href="/unfollow/{{username}}/{{accid}}" style="width: 27%; margin: 20px">Отписаться</a>
        {% else %}
            <a class="btn btn-success" href="/follow/{{username}}/{{accid}}" style="width: 27%; margin: 20px">Подписаться</a>
        {% endif %}
    {% endif %}
{% else %}
    <a class="btn btn-secondary" href="#" style="width: 27%; margin: 20px">Зарегистрируйтесь или войдите чтобы подписываться</a>
{% endif %}
<br><br>
    <ul>
        {% for post in posts %}
            <div class="post border rounded p-3 mb-3">
                <div class="media">
                    <img src={{post.avatar}} class="mr-3" alt="Аватар" style="width:64px;height:64px;border-radius:50%;">
                    <div class="media-body">
                        <h5 class="mt-0"><a href=/users/{{post.username}}>{{post.author}}</a></h5>
                        <hr>
                        <p>{{post.text}}</p>
                        {% if post.file_path %}
                            {% if post.file_type == "img" %}
                                <img src=/{{post.file_path}} style="width: 550px; height: auto;">
                            {% elif post.file_type == "video" %}
                                <video controls width="550">
                                  <source src=/{{post.file_path}} />
                                </video>
                            {% else %}
                                <p><a href=/{{post.file_path}}>Скачать файл</a></p>
                            {% endif %}
                        {% endif %}
                        <p class="post-date" style="color: grey; font-size: smaller;">{{post.time}}</p>
                    </div>
                </div>
            </div>
            <br>
        {% endfor %}
    </ul>
{% endblock %}