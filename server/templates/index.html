{% extends "base.html" %}

{% block content %}
<h1>Лента</h1>
{% if current_user.is_authenticated %}
    <a href="/newpost" class="btn btn-secondary">Создать квакание</a>
{% endif %}
<br><br>
    <ul>
        {% for post in posts %}
            <div class="post border rounded p-3 mb-3">
                <div class="media">
                    <img src={{post.avatar}} class="mr-3" alt="Аватар" style="width:64px;height:64px;border-radius:50%;">
                    <div class="media-body">
                        <h5 class="mt-0"><a href=/users/{{post.username}}>{{post.author}}</a></h5>
                        <hr>
                        <p>{{post.text}}</p>
                        {% if post.file_path %}
                            <p><a href="{{post.file_path}}">Скачать файл</a></p>
                        {% endif %}
                        <p class="post-date" style="color: grey; font-size: smaller;">{{post.time}}</p>
                    </div>
                </div>
            </div>
            <br>
        {% endfor %}
    </ul>
    <form action="" method="post" enctype="multipart/form-data">
        {{ form.hidden_tag() }}
        <p>
            {{ form.text.label }}<br>
            {{ form.text(class="form-control", type="text") }}<br>
            {% for error in form.text.errors %}
                <div class="alert alert-danger" role="alert">
                    {{ error }}
                </div>
            {% endfor %}
        </p>
        <p>
            {{ form.file.label }}<br>
            {{ form.file(class="form-control-file") }}<br>
            {% for error in form.file.errors %}
                <div class="alert alert-danger" role="alert">
                    {{ error }}
                </div>
            {% endfor %}
        </p>
        <p>{{ form.submit(type="submit", class="btn btn-primary") }}</p>
        <div>{{ message }}</div>
    </form>
{% endblock %}